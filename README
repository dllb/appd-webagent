https://dmsimard.com/2016/01/08/selinux-python-virtualenv-chroot-and-ansible-dont-play-nice/

Read this...
 Testing

cd /home/weblogic/projects/appd-webagent
git pull origin master
ansible -m ping -i hosts_qa.yml all 
ansible-playbook -i hosts_qa.yml appd_apache_agent.yml --limit test_host

nohup /app/AppDynamics/AppAgent/appdynamics-sdk-native/runSDKProxy.sh >>/dev/null 2> /app/AppDynamics/AppAgent/appdynamics-sdk-native/logs/proxy.out &

Read this...
# https://docs.appdynamics.com/display/PRO45/Install+the+Apache+Agent

chown httpd:httpd /app/httpd/conf

cd /home/weblogic/projects/appd-webagent
git pull origin master
ansible -m ping -i hosts_qa.yml all 
ansible-playbook -i hosts_qa.yml appd_apache_agent.yml --limit test_host

#CDA
cat > /tmp/apache.sh<<-EOM 
LD_LIBRARY_PATH="/app/httpd/lib:/app/httpd/conf/extra/wl-proxy/lib:$LD_LIBRARY_PATH:/app/httpd/conf/extra/weblogic/lib" 
export LD_LIBRARY_PATH
NETE_WA_ROOT=/app/webagent
export NETE_WA_ROOT
NETE_WA_PATH=${NETE_WA_ROOT}/bin
export NETE_WA_PATH
LD_LIBRARY_PATH=${NETE_WA_ROOT}/bin:${LD_LIBRARY_PATH}
export LD_LIBRARY_PATH
PATH=${NETE_WA_PATH}:${PATH}
export PATH
JAVA_HOME=/usr/java1.6
export JAVA_HOME
CAPKIHOME="/app/webagent/CAPKI"
export CAPKIHOME
/usr/sbin/apachectl -f /app/httpd/conf/httpd-cda.conf -k stop
sleep 15
/usr/sbin/apachectl -f /app/httpd/conf/httpd-cda.conf -k start
EOM

# WWW3
cat > /tmp/apache.sh<<-EOM 
LD_LIBRARY_PATH="/app/httpd/lib:/app/httpd/conf/extra/wl-proxy/lib:$LD_LIBRARY_PATH:/app/httpd/conf/extra/weblogic/lib" 
export LD_LIBRARY_PATH
NETE_WA_ROOT=/app/webagent
export NETE_WA_ROOT
NETE_WA_PATH=${NETE_WA_ROOT}/bin
export NETE_WA_PATH
LD_LIBRARY_PATH=${NETE_WA_ROOT}/bin:${LD_LIBRARY_PATH}
export LD_LIBRARY_PATH
PATH=${NETE_WA_PATH}:${PATH}
export PATH
JAVA_HOME=/usr/java1.6
export JAVA_HOME
CAPKIHOME="/app/webagent/CAPKI"
export CAPKIHOME
/usr/sbin/apachectl -f /app/httpd/conf/httpd-www3.conf -k stop
sleep 15
/usr/sbin/apachectl -f /app/httpd/conf/httpd-www3.conf -k start
EOM

cat > /tmp/apache.sh<<-EOM 
/usr/sbin/apachectl -f /app/httpd/conf/httpd-www3.conf -k stop
sleep 15
/usr/sbin/apachectl -f /app/httpd/conf/httpd-www3.conf -k start
EOM


#WWW4
cat > /tmp/apache.sh<<-EOM 
LD_LIBRARY_PATH="/app/httpd/lib:/app/httpd/conf/extra/wl-proxy/lib:$LD_LIBRARY_PATH:/app/httpd/conf/extra/weblogic/lib" 
export LD_LIBRARY_PATH
NETE_WA_ROOT=/app/webagent
export NETE_WA_ROOT
NETE_WA_PATH=${NETE_WA_ROOT}/bin
export NETE_WA_PATH
LD_LIBRARY_PATH=${NETE_WA_ROOT}/bin:${LD_LIBRARY_PATH}
export LD_LIBRARY_PATH
PATH=${NETE_WA_PATH}:${PATH}
export PATH
JAVA_HOME=/usr/java1.6
export JAVA_HOME
CAPKIHOME="/app/webagent/CAPKI"
export CAPKIHOME
/usr/sbin/apachectl -f /app/httpd/conf/httpd-www4.conf -k stop
sleep 15
/usr/sbin/apachectl -f /app/httpd/conf/httpd-www4.conf -k start
EOM

cat > /tmp/apache.sh<<-EOM 
/usr/sbin/apachectl -f /app/httpd/conf/httpd-www4.conf -k stop
sleep 15
/usr/sbin/apachectl -f /app/httpd/conf/httpd-www4.conf -k start
EOM


#httpd-mye.conf
cat > /tmp/apache.sh<<-EOM 
LD_LIBRARY_PATH="/app/httpd/lib:/app/httpd/conf/extra/wl-proxy/lib:$LD_LIBRARY_PATH:/app/httpd/conf/extra/weblogic/lib" 
export LD_LIBRARY_PATH
NETE_WA_ROOT=/app/webagent
export NETE_WA_ROOT
NETE_WA_PATH=${NETE_WA_ROOT}/bin
export NETE_WA_PATH
LD_LIBRARY_PATH=${NETE_WA_ROOT}/bin:${LD_LIBRARY_PATH}
export LD_LIBRARY_PATH
PATH=${NETE_WA_PATH}:${PATH}
export PATH
JAVA_HOME=/usr/java1.6
export JAVA_HOME
CAPKIHOME="/app/webagent/CAPKI"
export CAPKIHOME
/usr/sbin/apachectl -f /app/httpd/conf/httpd-mye.conf -k stop
sleep 15
/usr/sbin/apachectl -f /app/httpd/conf/httpd-mye.conf -k start
EOM

#Internal CDA
cat > /tmp/apache.sh<<-EOM 
/usr/sbin/apachectl -f /app/httpd/conf/httpd-cda.conf -k stop
sleep 15
/usr/sbin/apachectl -f /app/httpd/conf/httpd-cda.conf -k start
EOM


itwwwdev01
cat > /tmp/apache.sh <<- EOM 
sudo /usr/sbin/apachectl -f /app/httpd/conf/httpd-mye.conf -k stop
sleep 15
sudo /usr/sbin/apachectl -f /app/httpd/conf/httpd-mye.conf -k start
EOM

#CDA
cat > /tmp/apache.sh <<- EOM 
sudo /usr/sbin/apachectl -f /app/httpd/conf/httpd-cda.conf -k stop
sleep 15
sudo /usr/sbin/apachectl -f /app/httpd/conf/httpd-cda.conf -k start
EOM

#GENREF
cat > /tmp/apache.sh <<- EOM 
/usr/sbin/apachectl -f /app/httpd/conf/httpd-genref.conf -k stop
sleep 15
/usr/sbin/apachectl -f /app/httpd/conf/httpd-genref.conf -k start
EOM

### PROXY for Web Servers ###
pgrep runSDKProxy
pkill runSDKProxy
nohup /app/AppDynamics/AppAgent/appdynamics-sdk-native/runSDKProxy.sh >>/dev/null 2> /app/AppDynamics/AppAgent/appdynamics-sdk-native/logs/proxy.out &

AppDynamicsApplicationContext <application> <tier> <node> 

Include /app/httpd/conf/extra/appdynamics_agent.conf

CONF_FILE='httpd-secure.conf'
cat > /tmp/apache.sh <<- EOM
/usr/sbin/apachectl -f /app/httpd/conf/$CONF_FILE -k stop
sleep 15
/usr/sbin/apachectl -f /app/httpd/conf/$CONF_FILE -k start
EOM
